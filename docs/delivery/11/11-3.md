# [11-3] Select least-played solvable shuffle

[Back to task list](../tasks.md)

## Description
Implement selection logic that rotates through solvable shuffles, preferring unsolved entries and otherwise choosing the least-played shuffle.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-11-01 09:51:00 | Created | N/A | Proposed | Task created for solvable shuffle selection logic. | ai_agent |
| 2025-11-01 10:01:35 | user_approves | Proposed | Agreed | User approved solvable shuffle rotation task. | user |

## Requirements
- Track the number of times each solvable shuffle has been used and whether it was solved.
- Prefer shuffles that have not been solved; when all solved, choose the least-played.
- Fall back gracefully if history data is missing.

## Implementation Plan
1. Extend history storage (PBI 10) to include counts per solvable shuffle ID.
2. Implement helper that selects the next shuffle based on solved and play counts.
3. Integrate helper with game generator in Task 11-2.
4. Add tests covering scenarios: new dataset, partially solved, all solved.
5. Document selection strategy for future tuning.

## Test Plan
- `yarn test --watch=false` for selection helper.
- Manual: Play through multiple solvable games verifying rotation order.
- `yarn tsc --noEmit`.

## Verification
- Manual observation of shuffle rotation.
- `yarn test --watch=false`.
- `yarn tsc --noEmit`.

## Files Modified
- `src/state/history.ts`
- `src/solitaire/generator.ts`

