# 11-6 Klondike solver (deckOrder) + difficulty

[Back to task list](../tasks.md)

## Description
Implement a solver for Klondike (draw-1, unlimited recycles) that accepts a `deckOrder` permutation matching the engine’s `createDeck()` order and returns solvability plus a coarse difficulty. Provide a small Node test harness to run random shuffles.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-26 20:12:00 | Status Change | Proposed | InProgress | Started solver implementation and test harness. | ai-agent |
| 2025-11-01 11:44:00 | Status Change | InProgress | Review | Solver core implemented; CLI harness exercised for DFS and atomic strategies. | ai-agent |

## Requirements
- Input: `deckOrder: number[]` of length 52 mapping indices of `createDeck()`.
- Rules: draw-1, unlimited recycles; treat stock as unordered availability for playability checks.
- Output: `{ solvable: boolean, difficulty?: 'easy'|'medium'|'hard', stats: { nodes: number, depth: number, timeMs: number } }`.
- Performance: bounded search with pruning and transposition table.

## Implementation Plan
- Mirror move legality from engine; reuse ranks/suits and tableau/foundation rules.
- DFS with move ordering and pruning; transposition set keyed by a canonical state string.
- Difficulty buckets by nodes expanded and solution depth.
- Node script `scripts/solve-klondike.js` to print results for random shuffles.

## Verification
- `node scripts/solve-klondike.js --trials=5 --strategy=dfs` — completed; observed 2/5 solves with expected cutoff reporting.
- `node scripts/solve-klondike.js --trials=5 --strategy=atomic` — completed; atomic solver executed with config logging, matching DFS parity.
- `node scripts/solve-klondike.js --trials=5 --strategy=atomic --useNeededRanks=true` — sanity check to ensure optional heuristic flag passes through (see task 1-11).

## Files Modified
- `src/solitaire/klondike_solver.js` (new)
- `scripts/solve-klondike.js` (new)
