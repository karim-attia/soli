# [11-2] Enable solvable-only game setting

[Back to task list](../tasks.md)

## Description
Expose a setting allowing players to request solvable-only games which draw from the curated dataset.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-11-01 09:50:00 | Created | N/A | Proposed | Task created to enable solvable-only gameplay. | ai_agent |
| 2025-11-02 12:33:00 | user_approves | Proposed | Agreed | User approved solvable-only setting implementation. | user |
| 2025-11-02 12:34:00 | start_work | Agreed | InProgress | Began wiring settings toggle and reducer support. | ai_agent |
| 2025-11-02 13:07:00 | submit_for_review | InProgress | Review | Added solvable-only toggle, persistence, and board integration. | ai_agent |

## Requirements
- Add a toggle in the Settings screen that switches between standard shuffle and solvable-only modes.
- When enabled, new games should load from the dataset prepared in Task 11-1.
- Maintain compatibility with history, undo, and auto-play flows.

## Implementation Plan
1. Extend settings schema with a `solvableOnly` boolean.
2. Update new game generator to choose between random shuffle and dataset-sourced layout.
3. Ensure dataset-driven games still randomize the stock while respecting tableau layout.
4. Provide fallback behavior if dataset is empty.
5. Add tests covering generator selection logic.

## Test Plan
- Manual: Toggle solvable-only mode and start new games, verifying layouts match dataset entries.
- `yarn test --watch=false` for generator logic.
- `yarn tsc --noEmit`.

## Verification
- Manual game generation checks on iOS simulator and web.
- `yarn test --watch=false`.
- `yarn tsc --noEmit`.

## Files Modified
- `app/settings.tsx`
- `app/(tabs)/index.tsx`
- `src/state/settings.tsx`
- `src/solitaire/klondike.ts`
- `src/storage/gamePersistence.ts`

