# [18-1] Extract celebration mode metadata

[Back to task list](../tasks.md)

## Description
Move the celebration mode constants and transform logic out of the Klondike screen, document each mode with a human-readable name, and expose helpers the UI can consume when developer tooling needs them.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-11-06 14:30:00 | Created | N/A | Proposed | Drafted task scope for extracting celebration metadata. | ai_agent |
| 2025-11-06 14:31:00 | Status Change | Proposed | Agreed | User approved the celebration metadata refactor scope. | user |
| 2025-11-06 14:32:00 | Status Change | Agreed | InProgress | Started refactoring celebration logic into a dedicated module. | ai_agent |
| 2025-11-06 15:05:00 | Status Change | InProgress | Review | Celebration metadata module extracted and Klondike screen updated to use it. | ai_agent |

## Requirements
- Relocate celebration mode constants, helpers, and wobble math from `app/(tabs)/index.tsx` into a dedicated module under `src/animation/`.
- Provide a typed metadata structure that stores each modeâ€™s numeric identifier and a human-readable display name.
- Export functions that preserve the existing celebration motion calculations so existing behavior is unchanged.
- Ensure `app/(tabs)/index.tsx` consumes the new module for both constants and transform computations.

## Implementation Plan
1. Create `src/animation/celebrationModes.ts` containing mode metadata, exported constants, and a function that calculates per-card transform data given the current context.
2. Copy the existing switch-based transform logic from the Klondike screen into the new helper, adjusting inputs/outputs to avoid any UI-specific dependencies.
3. Export helpers for retrieving mode metadata (e.g., `getCelebrationModeMetadata`) and the constant `CELEBRATION_MODE_COUNT`, and update `index.tsx` to import them.
4. Remove the duplicated constants from `index.tsx`, wiring the celebration flow to use the new module without altering runtime behavior.

## Test Plan
- Launch the app, trigger a win (or use the demo auto-solve) and confirm celebrations still play without runtime errors.
- Run `yarn typecheck` to ensure the refactor introduces no TypeScript issues.
- Verify that the randomly selected celebration mode IDs remain within the expected range.

## Verification
- Manual win sequence validation in Expo Go (or simulator) after the refactor.
- `yarn typecheck`

## Files Modified
- `src/animation/celebrationModes.ts`
- `app/(tabs)/index.tsx`


