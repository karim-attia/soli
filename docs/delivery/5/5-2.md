# [5-2] Backfill tableau during stock traversal

[Back to task list](../tasks.md)

## Description
Enhance auto-complete to opportunistically move eligible tableau cards down while iterating through the stock, shortening endgame duration.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-11-01 09:25:00 | Created | N/A | Proposed | Task recorded to implement tableau backfill during auto-play. | ai_agent |
| 2025-11-01 09:59:25 | user_approves | Proposed | Agreed | User approved tableau backfill task. | user |

## Requirements
- Detect when tableau moves become available during stock iteration.
- Execute those moves in between stock draws without breaking auto-foundation timing.
- Avoid infinite loops or regressions in move ordering.

## Implementation Plan
1. Analyze the current auto-play loop to understand when tableau move opportunities are evaluated.
2. Introduce a helper that scans tableau columns after each action for promotable moves back to tableau or foundation.
3. Queue the additional moves while respecting animation sequencing.
4. Guard against repeated moves by marking processed states.
5. Update documentation on auto-play order and verify with tests.

## Test Plan
- Manual: Start auto-complete with remaining tableau moves and confirm they resolve without manual intervention.
- Manual: Ensure the sequence still terminates when no moves remain.
- `yarn test --watch=false`.
- `yarn tsc --noEmit`.

## Verification
- Manual observation of faster auto-complete flow on device/web.
- `yarn tsc --noEmit`.

## Files Modified
- `app/(tabs)/index.tsx`
- `src/solitaire/autoPlay.ts` (new or updated helper)

