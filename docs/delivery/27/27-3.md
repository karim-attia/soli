# Task 27-3: Add Refresh Rate Setting to State and UI

[Back to task list](./tasks.md)

## Description

Add refresh rate preference to the settings state system and create UI controls in the Settings screen.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-12-05 10:00:00 | Created | N/A | Proposed | Task file created | ai_agent |
| 2025-12-05 10:15:00 | Status Change | Proposed | Done | Settings state and UI implemented | ai_agent |

## Requirements

1. Add `refreshRateMode: 'auto' | 'high' | 'standard'` to SettingsState
2. Add setter function `setRefreshRateMode` to settings context
3. Persist preference via existing AsyncStorage mechanism
4. Add UI section in Settings screen under "Advanced"
5. Use radio-style button group for mutually exclusive options
6. Show description explaining battery implications

## Implementation Plan

### Settings State Changes

```typescript
// src/state/settings.tsx additions
export type RefreshRateMode = 'auto' | 'high' | 'standard'

export type SettingsState = {
  // ... existing fields
  refreshRateMode: RefreshRateMode
}

const DEFAULT_SETTINGS: SettingsState = {
  // ... existing defaults
  refreshRateMode: 'auto',
}
```

### UI Implementation

```tsx
// In app/settings.tsx
const refreshRateOptions: Array<{ mode: RefreshRateMode; label: string; description: string }> = [
  { mode: 'auto', label: 'Auto', description: 'Let Android decide based on content and battery' },
  { mode: 'high', label: 'High (120Hz)', description: 'Smoothest animations, uses more battery' },
  { mode: 'standard', label: 'Standard (60Hz)', description: 'Saves battery, may feel less smooth' },
]
```

### Platform Visibility

Only show on Android. Use `Platform.OS === 'android'` to conditionally render the section.

## Test Plan

### Success Criteria
- Setting appears in Advanced section on Android
- Setting is hidden on iOS/web
- Selecting an option persists across app restarts
- TypeScript types are correct

### Verification Steps
1. Open Settings on Android device
2. Verify refresh rate section appears under Advanced
3. Select each option and verify selection persists
4. Restart app and verify setting is restored
5. Verify section doesn't appear on iOS simulator

## Files Modified

- `src/state/settings.tsx`
- `app/settings.tsx`

