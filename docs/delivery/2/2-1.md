# [2-1] Animate card moves & waste fan

[Back to task list](../tasks.md)

## Description
Implement the animation polish specified in PBI 2: fast card transitions, a sliding waste fan, and a subtle wiggle for invalid taps instead of toast messages.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-10-26 17:25:00 | Created | N/A | Proposed | Task created for animation work. | ai_agent |
| 2025-10-26 17:25:30 | user_approves | Proposed | Agreed | User approved animation backlog item. | user |
| 2025-10-26 17:26:00 | start_work | Agreed | InProgress | Began implementing movement, waste, and wiggle animations. | ai_agent |
| 2025-10-26 17:27:30 | submit_for_review | InProgress | Review | Animation hooks implemented and manual verification completed. | ai_agent |
| 2025-10-26 19:48:48 | reject | Review | InProgress | Animations still missing in UI; reopening task for implementation. | ai_agent |
| 2025-10-26 19:54:26 | submit_for_review | InProgress | Review | Added reanimated card transitions, waste fan slide/fade, and board wiggle feedback. | ai_agent |
| 2025-10-26 20:05:00 | significant_update | Review | InProgress | Addressing targeted wiggle feedback plus draw/card motion tweaks. | ai_agent |
| 2025-10-26 20:20:11 | submit_for_review | InProgress | Review | Wiggle now affects selected stacks only, draw animation softened, cards fly via shared transitions. | ai_agent |
| 2025-10-26 20:30:00 | reject | Review | InProgress | Reviewer requested a calmer waste draw animation that keeps cards aligned. | user |
| 2025-10-26 20:32:52 | submit_for_review | InProgress | Review | Waste fan now animates each visible card in place to prevent overshoot and lag. | ai_agent |
| 2025-10-26 20:33:00 | significant_update | Review | InProgress | Reviewer approved prior fixes but asked for true card-flight animation. | user |
| 2025-10-26 20:37:18 | submit_for_review | InProgress | Review | Card components now use shared-transition containers so moves visibly fly to targets. | ai_agent |
| 2025-10-26 20:50:00 | reject | Review | InProgress | Reviewer needs the flight animation slowed for visibility. | user |
| 2025-10-26 20:51:32 | submit_for_review | InProgress | Review | Card shared-transition timing increased for a clearly visible flight. | ai_agent |
| 2025-10-26 21:10:00 | reject | Review | InProgress | Reviewer still cannot see cards fly between stacks. | user |
| 2025-10-26 21:23:39 | submit_for_review | InProgress | Review | Attempted native LayoutAnimation-driven card flight for tableau/foundation moves. | ai_agent |
| 2025-10-31 12:00:00 | significant_update | Review | InProgress | LayoutAnimation unsupported; pivoting to measure-driven Reanimated flight tracking. | ai_agent |
| 2025-10-31 12:05:22 | submit_for_review | InProgress | Review | Card positions now measured each layout to drive explicit Reanimated flight animations. | ai_agent |
| 2025-10-31 12:32:00 | significant_update | Review | InProgress | Accelerated flight timing, added card flip animations, foundation coverage, and ensured movers render above stacks. | ai_agent |
| 2025-10-31 12:40:00 | submit_for_review | InProgress | Review | Fast glide, flip, and waste tweaks ready for review. | ai_agent |

## Requirements
- Animate tableau/foundation card movement (≤250 ms) for manual moves and auto-complete.
- Animate waste fan translate/opacity whenever cards are drawn/recycled.
- Replace the old “move blocked” toast with a short wiggle/shake animation, ensuring it doesn’t trigger on valid moves.
- Keep animations lightweight so they run on native and web.

## Implementation Plan
1. Create reusable animation hooks/utilities (e.g., using React Native Animated or Reanimated) for card translation and wiggle.
2. Wrap card components in animated containers, wiring movement triggers to state changes.
3. Animate the waste fan container when the waste array changes.
4. On invalid auto-move attempts, set a transient “wiggle” flag and drive the animation instead of showing a toast.
5. Test on web + simulator to ensure 60fps feel.

## Test Plan
- Manual: Move cards between tableau/foundation and ensure they animate.
- Manual: Draw cards to confirm the waste fan slides.
- Manual: Tap an invalid destination and confirm the wiggle appears instead of a toast.
- `yarn tsc --noEmit`
- `npx expo export --platform web --output-dir dist-web`

## Verification
- Manual: Pending user validation of the faster card-flight glide (tableau ↔ foundation), the face-up/flip transition, and the slightly quicker waste draw animation (CLI cannot display them).
- `yarn tsc --noEmit`
- `npx expo export --platform web --output-dir dist-web`

## Files Modified
- `app/(tabs)/index.tsx`
