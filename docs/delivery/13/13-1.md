# [13-1] Define persistence schema and triggers

[Back to task list](../tasks.md)

## Description
Specify the structure of the saved-game payload and document when the app should persist or clear it so engineering work in Task 13-2 can follow a consistent contract.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-11-01 12:20:00 | Created | N/A | Proposed | Captured need to define saved-game schema and persistence moments. | ai_agent |
| 2025-11-01 12:22:00 | user_approves | Proposed | Agreed | User approved the scope for defining persistence schema and triggers. | user |

## Requirements
- Outline all fields needed to restore the Klondike reducer, including tableau, stock, waste, foundations, score, elapsed time, and undo history.
- Document when persistence must occur (per move, undo, stock recycle, explicit new game).
- Identify the storage key naming and versioning strategy for future migrations.

## Implementation Plan
1. Review the `KlondikeGameState` shape and undo stack to understand required data for a full restore.
2. Produce a schema definition (TypeScript type plus narrative) covering all persisted fields and version metadata.
3. Enumerate lifecycle events in which the UI will trigger persistence or clear the stored state.
4. Note migration considerations for potential future schema revisions.

## Test Plan
- Peer review the schema notes for completeness and correctness.
- `yarn tsc --noEmit` to ensure any referenced types compile once implemented.

## Verification
- Confirm schema documentation is referenced by Task 13-2 implementation plan.
- Run `yarn tsc --noEmit` after associated code changes.

## Files Modified
- `docs/delivery/13/prd.md`
- `docs/delivery/13/13-2.md` (implementation will reference schema)


