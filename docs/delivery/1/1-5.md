# [1-5] Responsive layout + header controls refresh

[Back to task list](../tasks.md)

## Description
Remove reliance on the horizontal ScrollView so the tableau columns always fit within the viewport, auto-resizing card dimensions as needed, and relocate the New Game action into the header area next to the existing "Hello!" button for fast restarts.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-10-26 14:10:00 | Created | N/A | Proposed | Task defined per new layout/header requirements. | ai_agent |
| 2025-10-26 14:11:00 | user_approves | Proposed | Agreed | User requested the layout + header updates. | user |
| 2025-10-26 14:12:00 | start_work | Agreed | InProgress | Began responsive sizing + header control implementation. | ai_agent |
| 2025-10-26 14:35:00 | submit_for_review | InProgress | Review | Layout fills the viewport and header hosts New Game button. | ai_agent |
| 2025-10-26 15:05:00 | significant_update | Review | InProgress | Scope expanded to rework full-width layout, waste fan, and card legibility. | ai_agent |
| 2025-10-26 15:25:00 | submit_for_review | InProgress | Review | Full-width layout, waste fan, and card styling refinements ready. | ai_agent |
| 2025-10-26 15:40:00 | significant_update | Review | InProgress | Additional scope: pacing auto-complete, draw ordering, updated copy. | ai_agent |
| 2025-10-26 15:55:00 | submit_for_review | InProgress | Review | Added paced auto-complete, draw/waste polish, and single-line instructions. | ai_agent |
| 2025-10-26 16:00:00 | approve | Review | Done | Task implementation approved by user. | user |

## Requirements
- Tableau columns must fit side-by-side regardless of device width by dynamically sizing card width/height ratios (no horizontal scrolling containers).
- Retain readable spacing/gaps while preventing overlapping or clipped cards.
- Move the New Game button into the tab header beside the "Hello!" button without regressing navigation behavior.
- Keep the foundations in a single row on the left, show the three-card waste fan immediately before the draw stack, and ensure left/right gutters remain symmetrical.
- Update card faces (tight top-corner labels + centered suit icon with smaller corner radius) and restyle the Moves counter to fit the new layout.
- Replace recycle wording with iconography/outline, allow foundation cards to auto/long-press back into play, and ensure Undo increments the move count.
- Pace auto-complete to roughly 5 cards per second while drawing/recycling from the stock when tableau moves are exhausted, with visible win celebration.
- Ensure the centered suit icon always renders (no ellipses), corner labels hug the top edge, and foundation placeholders stay muted until an ace starts the pile.
- Prevent double outlines or overlapping borders when tableau columns are empty.
- Hide the draw button once the game is won and prompt the user with a confirmation dialog before starting a new game.
- Keep draw pile to the left of the waste fan (showing the top three cards) while foundations stay on the left, maintaining symmetrical gutters.
- Auto-complete should pace at ~5 cards per second, draw/recycle from the stock if no tableau moves remain, and emit a win celebration once the game ends.
- Card face layout must show rank/suit in both top corners plus a centered suit icon without overflowing, and the Moves indicator should be restyled to stand out.

## Implementation Plan
1. Derive the available board width via `useWindowDimensions` (or layout event) and compute card width from constants + desired gaps.
2. Replace the horizontal ScrollView with a flex row that distributes seven columns using the computed width, ensuring overflow is eliminated.
3. Extract card dimensions into derived memoized values and apply them consistently to card, slot, and pile styles.
4. Update `app/(tabs)/_layout.tsx` to include a second header button that dispatches the reducer `NEW_GAME` action through a context or imperative callback.

## Test Plan
- Manual: Rotate simulator / resize browser and confirm seven tableau columns remain visible without horizontal scrolling.
- Manual: Trigger the header New Game button and ensure it resets the board while preserving the Hello link behavior.
- `yarn tsc --noEmit` to guarantee the responsive math + header plumbing type-checks.

## Verification
- Manually resized Expo web view + simulator to confirm all seven tableau columns stay on-screen without horizontal scrolling and that tableau now aligns to the right while foundations remain left.
- Verified the header New Game button (next to "Hello!") resets the reducer state instantly, the waste fan shows the last three cards (only the top card is interactive), and draw/waste spacing mirrors the foundations section.
- Triggered auto-complete to confirm it draws/recycles through the stock when needed, advances about five cards per second, and displays a ðŸŽ‰ toast when foundations complete.
- Confirmed the concise description + Moves pill render correctly across breakpoints.
- `yarn tsc --noEmit` and `npx expo export --platform web --output-dir dist-web` both pass, covering type safety and bundle integrity.

## Files Modified
- `app/(tabs)/index.tsx`
- `app/(tabs)/_layout.tsx`
- `src/solitaire/klondike.ts`
