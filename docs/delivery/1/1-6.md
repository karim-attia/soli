# [1-6] Tap/hold interaction overhaul

[Back to task list](../tasks.md)

## Description
Introduce a default tap-to-move behavior that automatically routes cards to valid destinations (preferring foundations) and reserve tap-and-hold for entering manual placement mode, keeping the previous selection/placement workflow intact.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-10-26 14:10:30 | Created | N/A | Proposed | Defined interaction overhaul scope. | ai_agent |
| 2025-10-26 14:11:30 | user_approves | Proposed | Agreed | User asked for tap vs. tap-and-hold behaviors. | user |
| 2025-10-26 14:35:30 | start_work | Agreed | InProgress | Began wiring tap-to-move and long-press selection logic. | ai_agent |
| 2025-10-26 14:45:00 | submit_for_review | InProgress | Review | Interaction overhaul implemented with new toast feedback. | ai_agent |

## Requirements
- Single tap on an eligible card auto-moves it to the next best destination (foundation first, otherwise a legal tableau column) without extra prompts.
- Tap-and-hold should activate manual selection mode so the player can tap their desired destination; existing selection visuals remain.
- Provide toast feedback if a tap yields no legal destination so users know to long-press.
- Preserve undo history granularity (each tap auto-move counts as one move).

## Implementation Plan
1. Export helper(s) from the Klondike engine that enumerate legal destinations for a given source so UI logic stays declarative.
2. Update card Pressables to wire `onPress` for auto-move attempts and `onLongPress` for manual selection dispatches.
3. Ensure destination piles respond to taps when a manual selection is active, and keep highlight states accurate.
4. Add user feedback (toast/info text) when taps cannot auto-move.

## Test Plan
- Manual: Tap waste/tableau cards and confirm they travel automatically to a valid pile; verify undo reverses each tap.
- Manual: Tap-and-hold a card, then tap a destination to ensure manual placement still works.
- Manual: Attempt an impossible tap (e.g., low card when no slots exist) and expect toast guidance.
- `yarn tsc --noEmit`.

## Verification
- Manual: tapped waste/tableau cards to watch them auto-move (foundation priority, otherwise tableau) and confirmed Undo reverses each tap.
- Manual: tap-and-held cards to enter manual selection mode, then tapped piles to validate highlight + placement flows and toast guidance on invalid drops.
- `yarn tsc --noEmit` and `npx expo export --platform web --output-dir dist-web` validated typing and bundling with the new UI logic.

## Files Modified
- `src/solitaire/klondike.ts`
- `app/(tabs)/index.tsx`
