# [14-2] Implement centralized flight controller

[Back to task list](../tasks.md)

## Description
Design and integrate a single controller that coordinates card snapshot collection, dispatch timing, and animation scheduling for all move types.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-11-02 17:00:00 | Created | N/A | Proposed | Task created to build the new deterministic flight controller. | ai_agent |

## Requirements
- Provide an API for queuing moves that blocks until origin/target snapshots are available.
- Support manual moves, auto-queue sequences, undo, and celebrations without regressions.
- Ensure controller can be unit/integration tested in isolation.

## Implementation Plan
1. Define controller responsibilities and interfaces (e.g., context provider or service module).
2. Refactor UI components to register snapshot updates with the controller instead of mutating shared refs.
3. Update reducer/dispatcher paths to route through the controllerâ€™s scheduling API.
4. Add safeguards for timeouts or fallbacks with clear telemetry.

## Test Plan
- Unit: Simulate move scheduling with mocked snapshots to ensure controller waits correctly.
- Integration: Drive automated tests that validate sequential and concurrent moves animate as expected.
- Manual: Verify on device that previously missing flights now render consistently.

## Verification
- Controller implementation merged with tests and manual QA notes attached before Review.

## Files Modified
- Core flight controller module (new).
- `app/(tabs)/index.tsx` (wiring) and related components.


