# 10-6 Add active status and update entry on completion

[Back to task list](./tasks.md)

## Description
Fix history entries being duplicated when a game is started and then completed. When a game starts, create an entry with status 'active'. When that specific game session ends, update the same entry (by its unique entry ID) to 'solved' or 'incomplete'.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-12-09 | Created | N/A | InProgress | Task created and implementation started | AI |
| 2025-12-09 | Status Change | InProgress | Review | Implementation complete, ready for review | AI |

## Requirements
1. Add new status values: 'active', 'incomplete', 'solved'
2. recordResult returns the created entry's ID
3. Add updateEntry(id, updates) function to update an existing entry by its unique ID
4. Store current game's entry ID and use it when game ends
5. UI should display the appropriate status label for each game state

## Implementation Plan
1. Add `status: 'active' | 'incomplete' | 'solved'` field to HistoryEntry type
2. Modify `recordResult` to return the created entry's ID
3. Add `updateEntry(id, updates)` function to context
4. In useKlondikeGame, track currentGameEntryIdRef
5. Update UI to show 'Active', 'Incomplete', or 'Solved' status labels

## Verification
- Starting a new game creates one entry with status 'active'
- Completing a game updates that same entry to status 'solved'
- Abandoning a game updates it to status 'incomplete'
- Playing the same shuffle twice creates two separate entries

## Files Modified
- src/state/history.tsx - Add HistoryEntryStatus type, status field, return ID from recordResult, add updateEntry function, add activeCount
- src/features/klondike/hooks/useKlondikeGame.ts - Track currentGameEntryIdRef, rewrite recordCurrentGameResult to use updateEntry
- src/features/klondike/hooks/useDemoGameLauncher.ts - Rename lastRecordedShuffleRef to currentGameEntryIdRef
- app/history.tsx - Update UI to show 'Active', 'Incomplete', 'Solved' status labels with appropriate colors
