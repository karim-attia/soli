# [4-2] Ensure foundation transitions animate

[Back to task list](../tasks.md)

## Description
Guarantee that all tableau-to-foundation moves, including auto-foundation sequences, flow through the shared card flight animation system instead of snapping into place.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 2025-11-01 09:21:00 | Created | N/A | Proposed | Task documented to cover missing foundation transition animations. | ai_agent |
| 2025-11-01 09:59:05 | user_approves | Proposed | Agreed | User approved foundation animation task. | user |

## Requirements
- Route manual foundation moves through the shared transition container with correct z-indexing.
- Integrate auto-foundation logic with the same animation trigger path.
- Preserve existing move validation and undo history behaviors.

## Implementation Plan
1. Review the move reducer + animation bridge to identify where foundation moves bypass the shared transition path.
2. Introduce a unified helper that triggers card flights for both manual and auto-foundation moves.
3. Ensure card depth ordering keeps moving cards above stationary stacks during animation.
4. Validate undo interactions still replay via the same animation pipeline (ties into Task 4-1).
5. Update relevant unit/integration tests or add new coverage for the shared path.

## Test Plan
- Manual: Drag a tableau card to the foundation and confirm the card flies along the calculated path.
- Manual: Trigger auto-foundation and ensure each card animates sequentially instead of teleporting.
- Manual: Undo an auto-foundation step to ensure animation still plays when the card returns.
- `yarn tsc --noEmit`.

## Verification
- Manual verification of foundation moves on device and web.
- `yarn tsc --noEmit`.

## Files Modified
- `app/(tabs)/index.tsx`
- `src/solitaire/klondike.ts`

