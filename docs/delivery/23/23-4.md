# 23-4 Isolate orchestration hooks

[Back to task list](../tasks.md)

## Description
Refactor stateful logic such as timers, persistence, solvable shuffle selection, and celebration lifecycle into reusable hooks that encapsulate side effects outside the main Klondike screen component.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-11-12 13:14:00 | Created | N/A | Proposed | Task documented per refactor analysis. | ai_agent |

## Requirements
- Introduce hooks under `src/features/klondike/hooks` to encapsulate timer management, storage hydration/persistence, solvable shuffle rotation, and celebration lifecycle control.
- Ensure hooks expose clear inputs/outputs without relying on ambient module state.
- Update the Klondike screen to consume these hooks, reducing inline effect noise and improving readability.
- Document each hook’s purpose and key side effects with JSDoc or inline comments.

## Implementation Plan
1. Create hook files (e.g., `useKlondikeTimer`, `useKlondikePersistence`, `useSolvableShuffleSelector`, `useCelebrationController`).
2. Move corresponding logic from `app/(tabs)/index.tsx`, adapting dependencies to hook arguments and return values.
3. Maintain compatibility with existing reducers and controllers (`useFlightController`, `useAnimationToggles`).
4. Replace in-file effects with hook invocations, adding comments in `index.tsx` describing each hook’s responsibility.
5. Add barrel exports (`src/features/klondike/hooks/index.ts`) to streamline imports.

## Test Plan
- Run through hydration scenarios (resume game, finished game) to confirm persistence still works.
- Validate timer behaviour (start on first move, pause/resume with app state) and celebration lifecycle after wins.
- Execute `yarn test` or relevant scripts if available; otherwise rely on manual verification and `yarn tsc --noEmit`.

## Verification
- Confirm the screen component no longer contains the previous effect chains, instead delegating to the extracted hooks.
- Ensure no regressions in auto-complete, undo, or celebration workflows.

## Files Modified
- _TBD during implementation_

